<!-- templates/browse.html -->
{% extends "base.html" %}

{% block title %}Browse {{ path }}{% endblock %}

{% block content %}
<!-- <h2>Path: {{ path }}</h2> -->

<!-- Хлебные крошки -->
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        {% for crumb in breadcrumbs %}
        {% if not loop.last %}
        <li class="breadcrumb-item">
            <a href="{{ url_for('browse', file_path=crumb.path) }}">{{ crumb.name }}</a>
        </li>
        {% else %}
        <li class="breadcrumb-item active" aria-current="page">{{ crumb.name }}</li>
        {% endif %}
        {% endfor %}
    </ol>
</nav>

<!-- Кнопки Home, Go Up и плейлист -->
<div class="d-flex align-items-center mb-3">
    <!-- Кнопка Home -->
    <a href="{{ url_for('index') }}" class="btn btn-secondary mr-3">
        <i class="fas fa-home"></i> Home
    </a>

    <!-- Кнопка возврата к родительской папке -->
    {% if parent_dir %}
    <a href="{{ url_for('browse', file_path=parent_dir) }}" class="btn btn-primary mr-auto">Go Up</a>
    {% endif %}

    <!-- Кнопки для создания плейлиста -->
    <div class="d-flex">
        <button type="button" class="btn btn-success mr-2" data-bs-toggle="modal" data-bs-target="#playlistModal">
            Add to Playlist
        </button>
        <form action="{{ url_for('browse', file_path=path) }}" method="post" class="d-inline">
            <input type="hidden" name="action" value="add_all">
            <button type="submit" class="btn btn-info">Add all to Playlist</button>
        </form>
    </div>
</div>


<!-- Список папок -->

<h3>Folders:</h3>
<ul class="list-unstyled">
    {% if folders %}
    {% for folder in folders %}
    <li class="folder d-flex align-items-center mb-2">
        <i class="fas fa-folder text-warning mr-2"></i> <!-- Отступ справа -->
        <a href="{{ url_for('browse', file_path=join(path, folder)) }}" class="text-decoration-none">{{ folder }}</a>
    </li>
    {% endfor %}
    {% else %}
    <li class="text-muted">No folders found.</li>
    {% endif %}
</ul>

<!-- Список файлов -->
<h3>Files:</h3>
<ul class="list-unstyled">
    {% if files %}
    {% for file in files %}
    <li class="file d-flex align-items-center mb-2">
        <i class="fas fa-file-audio text-primary mr-2"></i>
        <label>{{ file }}</label>
    </li>
    {% endfor %}
</ul>

    <!-- Модальное окно для создания плейлиста -->
    <div class="modal fade" id="playlistModal" tabindex="-1" role="dialog" aria-labelledby="playlistModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="playlistModalLabel">Create Playlist</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Select files to add to the playlist:</p>
                    <form id="modalPlaylistForm" action="{{ url_for('browse', file_path=path) }}" method="post">
                        <input type="hidden" name="action" value="add_selected">
                        <ul>
                            {% for file in files %}
                            <li>
                                <input type="checkbox" name="files" value="{{ file }}"> {{ file }}
                            </li>
                            {% endfor %}
                        </ul>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" form="modalPlaylistForm" class="btn btn-primary">Create Playlist</button>
                </div>
            </div>
        </div>
    </div>

    {% else %}
    <li class="text-muted">No files found.</li>
    {% endif %}
</ul>
{% endblock %}